'use strict';

// Compatibility check
const nodeVersion = require('node-version');
const versionCompare = require('compare-versions');

class CompatibilityChecker {
  static isNodeCompatible(packageConfig) {
    const nodeVersionInPackage = (CompatibilityChecker.isDefined(packageConfig) && CompatibilityChecker.isDefined(packageConfig.engines) && CompatibilityChecker.isDefined(packageConfig.engines.node)) ? packageConfig.engines.node.replace(/[><=]/g, '') : '0.0.0';
    let result = true;
    let msg = 'Node version is compatible';
    if (versionCompare(nodeVersion.long, nodeVersionInPackage) < 0) {
      msg = `This application requires node ${nodeVersionInPackage} or higher. Please upgrade your node version and try again`;
      result = false;
    }
    return { result, msg };
  }
  static isDefined(variable) {
    if (typeof variable !== 'undefined' && variable !== null) { return true; }
    return false;
  }
}

module.exports = CompatibilityChecker;

